

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FPU Functions &mdash; NMSIS 1.0.2-RC1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Intrinsic Functions for SIMD Instructions" href="api_nmsis_core_dsp_intrinsic.html" />
    <link rel="prev" title="SysTimer Functions" href="api_nmsis_core_systimer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/nmsis_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0.2-RC1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/introduction.html">Nuclei MCU Software Interface Standard(NMSIS)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">NMSIS Core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started.html">Using NMSIS in Embedded Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_templates.html">NMSIS-Core Device Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../register_mapping.html">Register Mapping</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">NMSIS CORE API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_versioncontrol.html">Version Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_compilercontrol.html">Compiler Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_periphaccess.html">Peripheral Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_csr_encoding.html">Core CSR Encodings</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_registers.html">Register Define and Type Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_csr_register_access.html">Core CSR Register Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_cpu_intrinsic.html">Intrinsic Functions for CPU Intructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_intexc.html">Interrupts and Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_systimer.html">SysTimer Functions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">FPU Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_dsp_intrinsic.html">Intrinsic Functions for SIMD Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_pmp_functions.html">PMP Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_cache.html">Cache Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nmsis_core_armcompatiable_functions.html">ARM Compatiable Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dsp/index.html">NMSIS DSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nn/index.html">NMSIS NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html">Appendix</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NMSIS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">NMSIS Core</a> &raquo;</li>
        
          <li><a href="index.html">NMSIS CORE API</a> &raquo;</li>
        
      <li>FPU Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/core/api/api_nmsis_core_fpu_functions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="fpu-functions">
<span id="nmsis-core-api-fpu-functions"></span><h1>FPU Functions<a class="headerlink" href="#fpu-functions" title="Permalink to this headline">¶</a></h1>
<dl class="type">
<dt id="_CPPv48rv_fpu_t">
<span id="_CPPv38rv_fpu_t"></span><span id="_CPPv28rv_fpu_t"></span><span id="rv_fpu_t"></span><span class="target" id="group__NMSIS__Core__FPU__Functions_1ga2e1e58dd537699f8674a335d64c8705a"></span><em class="property">typedef </em>uint64_t <code class="sig-name descname">rv_fpu_t</code><a class="headerlink" href="#_CPPv48rv_fpu_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__RISCV_FLEN">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gafa83f561b446add5c453e0feb255d2e6"></span><code class="sig-name descname">__RISCV_FLEN</code> 64<a class="headerlink" href="#c.__RISCV_FLEN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__get_FCSR">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga8cc990586c8cd66746a89ea04a952306"></span><code class="sig-name descname">__get_FCSR</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_READ(CSR_FCSR)<a class="headerlink" href="#c.__get_FCSR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__set_FCSR">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga2a5b820d47fe120ac23382db72f6cbb8"></span><code class="sig-name descname">__set_FCSR</code><span class="sig-paren">(</span>val<span class="sig-paren">)</span> __RV_CSR_WRITE(CSR_FCSR, (val))<a class="headerlink" href="#c.__set_FCSR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__get_FRM">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gaa6595ca9d101dda1feb9826d0905bd60"></span><code class="sig-name descname">__get_FRM</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_READ(CSR_FRM)<a class="headerlink" href="#c.__get_FRM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__set_FRM">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gaae42d30f7a65effccb13210406c69f6a"></span><code class="sig-name descname">__set_FRM</code><span class="sig-paren">(</span>val<span class="sig-paren">)</span> __RV_CSR_WRITE(CSR_FRM, (val))<a class="headerlink" href="#c.__set_FRM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__get_FFLAGS">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gaa679e9260657efa33c5340841e8a6aff"></span><code class="sig-name descname">__get_FFLAGS</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_READ(CSR_FFLAGS)<a class="headerlink" href="#c.__get_FFLAGS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__set_FFLAGS">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga5c875e72325d398dc16301eec09eec0d"></span><code class="sig-name descname">__set_FFLAGS</code><span class="sig-paren">(</span>val<span class="sig-paren">)</span> __RV_CSR_WRITE(CSR_FFLAGS, (val))<a class="headerlink" href="#c.__set_FFLAGS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__enable_FPU">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga56907288398563598c7ed6c203bde07c"></span><code class="sig-name descname">__enable_FPU</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_SET(CSR_MSTATUS, MSTATUS_FS)<a class="headerlink" href="#c.__enable_FPU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__disable_FPU">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga3cb1d30a444036111b1e83853315e11a"></span><code class="sig-name descname">__disable_FPU</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_CLEAR(CSR_MSTATUS, MSTATUS_FS)<a class="headerlink" href="#c.__disable_FPU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__RV_FLW">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gada7714c5b13faee62cd17c11b33099bc"></span><code class="sig-name descname">__RV_FLW</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span><a class="headerlink" href="#c.__RV_FLW" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__RV_FSW">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga8589da14b8ba3b8370752efc3e71f060"></span><code class="sig-name descname">__RV_FSW</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span><a class="headerlink" href="#c.__RV_FSW" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__RV_FLD">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gad4c739198e28d81dc036a4ceafeaaa14"></span><code class="sig-name descname">__RV_FLD</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span><a class="headerlink" href="#c.__RV_FLD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__RV_FSD">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gacabdf0d10c9c364361d498887d2a31ee"></span><code class="sig-name descname">__RV_FSD</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span><a class="headerlink" href="#c.__RV_FSD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__RV_FLOAD">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga7284e0420eb63c1858739f326695c3d7"></span><code class="sig-name descname">__RV_FLOAD</code> __RV_FLD<a class="headerlink" href="#c.__RV_FLOAD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.__RV_FSTORE">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gafeca0b04cdcb27f77b10f2ece682e4a3"></span><code class="sig-name descname">__RV_FSTORE</code> __RV_FSD<a class="headerlink" href="#c.__RV_FSTORE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.SAVE_FPU_CONTEXT">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga84c57d7bc6ecc4dcb457283e84636cb0"></span><code class="sig-name descname">SAVE_FPU_CONTEXT</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.SAVE_FPU_CONTEXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.RESTORE_FPU_CONTEXT">
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga9a78b83eedadc42478e23a10aa8ebc07"></span><code class="sig-name descname">RESTORE_FPU_CONTEXT</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.RESTORE_FPU_CONTEXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="group">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions"></span><em>group</em> <code class="sig-name descname">NMSIS_Core_FPU_Functions</code></dt>
<dd><p>Functions that related to the RISC-V FPU (F and D extension). </p>
<p>Nuclei provided floating point unit by RISC-V F and D extension.<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F</span> <span class="pre">extension</span></code> adds single-precision floating-point computational instructions compliant with the IEEE 754-2008 arithmetic standard, __RISCV_FLEN = 32. The F extension adds 32 floating-point registers, f0-f31, each 32 bits wide, and a floating-point control and status register fcsr, which contains the operating mode and exception status of the floating-point unit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">extension</span></code> adds double-precision floating-point computational instructions compliant with the IEEE 754-2008 arithmetic standard. The D extension widens the 32 floating-point registers, f0-f31, to 64 bits, __RISCV_FLEN = 64 </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gafa83f561b446add5c453e0feb255d2e6"></span><code class="sig-name descname">__RISCV_FLEN</code> 64</dt>
<dd></dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga8cc990586c8cd66746a89ea04a952306"></span><code class="sig-name descname">__get_FCSR</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_READ(CSR_FCSR)</dt>
<dd><p>Get FCSR CSR Register. </p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga2a5b820d47fe120ac23382db72f6cbb8"></span><code class="sig-name descname">__set_FCSR</code><span class="sig-paren">(</span>val<span class="sig-paren">)</span> __RV_CSR_WRITE(CSR_FCSR, (val))</dt>
<dd><p>Set FCSR CSR Register with val. </p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gaa6595ca9d101dda1feb9826d0905bd60"></span><code class="sig-name descname">__get_FRM</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_READ(CSR_FRM)</dt>
<dd><p>Get FRM CSR Register. </p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gaae42d30f7a65effccb13210406c69f6a"></span><code class="sig-name descname">__set_FRM</code><span class="sig-paren">(</span>val<span class="sig-paren">)</span> __RV_CSR_WRITE(CSR_FRM, (val))</dt>
<dd><p>Set FRM CSR Register with val. </p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gaa679e9260657efa33c5340841e8a6aff"></span><code class="sig-name descname">__get_FFLAGS</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_READ(CSR_FFLAGS)</dt>
<dd><p>Get FFLAGS CSR Register. </p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga5c875e72325d398dc16301eec09eec0d"></span><code class="sig-name descname">__set_FFLAGS</code><span class="sig-paren">(</span>val<span class="sig-paren">)</span> __RV_CSR_WRITE(CSR_FFLAGS, (val))</dt>
<dd><p>Set FFLAGS CSR Register with val. </p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga56907288398563598c7ed6c203bde07c"></span><code class="sig-name descname">__enable_FPU</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_SET(CSR_MSTATUS, MSTATUS_FS)</dt>
<dd><p>Enable FPU Unit. </p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga3cb1d30a444036111b1e83853315e11a"></span><code class="sig-name descname">__disable_FPU</code><span class="sig-paren">(</span><span class="sig-paren">)</span> __RV_CSR_CLEAR(CSR_MSTATUS, MSTATUS_FS)</dt>
<dd><p>Disable FPU Unit. </p>
<p><ul class="simple">
<li><p>We can save power by disable FPU Unit.</p></li>
<li><p>When FPU Unit is disabled, any access to FPU related CSR registers and FPU instructions will cause illegal Instuction Exception. </p></li>
</ul>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gada7714c5b13faee62cd17c11b33099bc"></span><code class="sig-name descname">__RV_FLW</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span></dt>
<dd><p>Load a single-precision value from memory into float point register freg using flw instruction. </p>
<p>The FLW instruction loads a single-precision floating point value from memory address (addr + ofs) into floating point register freg(f0-f31) <dl class="simple">
<dt><strong>Remark</strong></dt><dd><p><ul class="simple">
<li><p>FLW and FSW operations need to make sure the address is 4 bytes aligned, otherwise it will cause exception code 4(Load address misaligned) or 6 (Store/AMO address misaligned)</p></li>
<li><p>FLW and FSW do not modify the bits being transferred; in particular, the payloads of non-canonical NaNs are preserved </p></li>
</ul>
</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">freg</span></code>: The floating point register, eg. FREG(0), f0 </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">addr</span></code>: The memory base address, 4 byte aligned required </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">ofs</span></code>: a 12-bit immediate signed byte offset value, should be an const value </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga8589da14b8ba3b8370752efc3e71f060"></span><code class="sig-name descname">__RV_FSW</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span></dt>
<dd><p>Store a single-precision value from float point freg into memory using fsw instruction. </p>
<p>The FSW instruction stores a single-precision value from floating point register to memory <dl class="simple">
<dt><strong>Remark</strong></dt><dd><p><ul class="simple">
<li><p>FLW and FSW operations need to make sure the address is 4 bytes aligned, otherwise it will cause exception code 4(Load address misaligned) or 6 (Store/AMO address misaligned)</p></li>
<li><p>FLW and FSW do not modify the bits being transferred; in particular, the payloads of non-canonical NaNs are preserved </p></li>
</ul>
</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">freg</span></code>: The floating point register(f0-f31), eg. FREG(0), f0 </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">addr</span></code>: The memory base address, 4 byte aligned required </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">ofs</span></code>: a 12-bit immediate signed byte offset value, should be an const value </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gad4c739198e28d81dc036a4ceafeaaa14"></span><code class="sig-name descname">__RV_FLD</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span></dt>
<dd><p>Load a double-precision value from memory into float point register freg using fld instruction. </p>
<p>The FLD instruction loads a double-precision floating point value from memory address (addr + ofs) into floating point register freg(f0-f31) <dl class="simple">
<dt><strong>Attention</strong></dt><dd><p><ul class="simple">
<li><p>Function only available for double precision floating point unit, FLEN = 64 </p></li>
</ul>
</p>
</dd>
<dt><strong>Remark</strong></dt><dd><p><ul class="simple">
<li><p>FLD and FSD operations need to make sure the address is 8 bytes aligned, otherwise it will cause exception code 4(Load address misaligned) or 6 (Store/AMO address misaligned)</p></li>
<li><p>FLD and FSD do not modify the bits being transferred; in particular, the payloads of non-canonical NaNs are preserved. </p></li>
</ul>
</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">freg</span></code>: The floating point register, eg. FREG(0), f0 </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">addr</span></code>: The memory base address, 8 byte aligned required </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">ofs</span></code>: a 12-bit immediate signed byte offset value, should be an const value </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gacabdf0d10c9c364361d498887d2a31ee"></span><code class="sig-name descname">__RV_FSD</code><span class="sig-paren">(</span>freg, addr, ofs<span class="sig-paren">)</span></dt>
<dd><p>Store a double-precision value from float point freg into memory using fsd instruction. </p>
<p>The FSD instruction stores double-precision value from floating point register to memory <dl class="simple">
<dt><strong>Attention</strong></dt><dd><p><ul class="simple">
<li><p>Function only available for double precision floating point unit, FLEN = 64 </p></li>
</ul>
</p>
</dd>
<dt><strong>Remark</strong></dt><dd><p><ul class="simple">
<li><p>FLD and FSD operations need to make sure the address is 8 bytes aligned, otherwise it will cause exception code 4(Load address misaligned) or 6 (Store/AMO address misaligned)</p></li>
<li><p>FLD and FSD do not modify the bits being transferred; in particular, the payloads of non-canonical NaNs are preserved. </p></li>
</ul>
</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">freg</span></code>: The floating point register(f0-f31), eg. FREG(0), f0 </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">addr</span></code>: The memory base address, 8 byte aligned required </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">ofs</span></code>: a 12-bit immediate signed byte offset value, should be an const value </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga7284e0420eb63c1858739f326695c3d7"></span><code class="sig-name descname">__RV_FLOAD</code> __RV_FLD</dt>
<dd><p>Load a float point value from memory into float point register freg using flw/fld instruction. </p>
<p><ul class="simple">
<li><p>For Single-Precison Floating-Point Mode(__FPU_PRESENT == 1, __RISCV_FLEN == 32): It will call __RV_FLW to load a single-precision floating point value from memory to floating point register</p></li>
<li><p>For Double-Precison Floating-Point Mode(__FPU_PRESENT == 2, __RISCV_FLEN == 64): It will call __RV_FLD to load a double-precision floating point value from memory to floating point register</p></li>
</ul>
</p>
<p><dl class="simple">
<dt><strong>Attention</strong></dt><dd><p>Function behaviour is different for __FPU_PRESENT = 1 or 2, please see the real function this macro represent </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1gafeca0b04cdcb27f77b10f2ece682e4a3"></span><code class="sig-name descname">__RV_FSTORE</code> __RV_FSD</dt>
<dd><p>Store a float value from float point freg into memory using fsw/fsd instruction. </p>
<p><ul class="simple">
<li><p>For Single-Precison Floating-Point Mode(__FPU_PRESENT == 1, __RISCV_FLEN == 32): It will call __RV_FSW to store floating point register into memory</p></li>
<li><p>For Double-Precison Floating-Point Mode(__FPU_PRESENT == 2, __RISCV_FLEN == 64): It will call __RV_FSD to store floating point register into memory</p></li>
</ul>
</p>
<p><dl class="simple">
<dt><strong>Attention</strong></dt><dd><p>Function behaviour is different for __FPU_PRESENT = 1 or 2, please see the real function this macro represent </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga84c57d7bc6ecc4dcb457283e84636cb0"></span><code class="sig-name descname">SAVE_FPU_CONTEXT</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Save FPU context into variables for interrupt nesting. </p>
<p>This macro is used to declare variables which are used for saving FPU context, and it will store the nessary fpu registers into these variables, it need to be used in a interrupt when in this interrupt fpu registers are used. <dl class="simple">
<dt><strong>Remark</strong></dt><dd><p><ul class="simple">
<li><p>It need to be used together with RESTORE_FPU_CONTEXT</p></li>
<li><p>Don’t use variable names __fpu_context in your ISR code</p></li>
<li><p>If you isr code will use fpu registers, and this interrupt is nested. Then you can do it like this: <div class="highlight-default notranslate"><div class="highlight"><pre><span></span>void eclic_mtip_handler(void)
{
    // !!!Interrupt is enabled here!!!
    // !!!Higher priority interrupt could nest it!!!

    // Necessary only when you need to use fpu registers
    // in this isr handler functions
    SAVE_FPU_CONTEXT();

    // put you own interrupt handling code here

    // pair of SAVE_FPU_CONTEXT()
    RESTORE_FPU_CONTEXT();
}
</pre></div>
</div>
 </p></li>
</ul>
</p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga9a78b83eedadc42478e23a10aa8ebc07"></span><code class="sig-name descname">RESTORE_FPU_CONTEXT</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Restore necessary fpu registers from variables for interrupt nesting. </p>
<p>This macro is used restore necessary fpu registers from pre-defined variables in SAVE_FPU_CONTEXT macro. <dl class="simple">
<dt><strong>Remark</strong></dt><dd><p><ul class="simple">
<li><p>It need to be used together with SAVE_FPU_CONTEXT </p></li>
</ul>
</p>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="type">
<dt>
<span class="target" id="group__NMSIS__Core__FPU__Functions_1ga2e1e58dd537699f8674a335d64c8705a"></span><em class="property">typedef </em>uint64_t <code class="sig-name descname">rv_fpu_t</code><br /></dt>
<dd><p>Type of FPU register, depends on the FLEN defined in RISC-V. </p>
</dd></dl>

</div>
</dd></dl>

</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api_nmsis_core_dsp_intrinsic.html" class="btn btn-neutral float-right" title="Intrinsic Functions for SIMD Instructions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api_nmsis_core_systimer.html" class="btn btn-neutral float-left" title="SysTimer Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-Present, Nuclei
      <span class="lastupdated">
        Last updated on Aug 06, 2021.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>